# tmux config file

# command descriptions: 
# https://man7.org/linux/man-pages/man1/tmux.1.html

### key bindings ###

# reload config
bind r source-file ~/.tmux.conf \; display-message ".tmux.conf reloaded"
bind -n C-p command

# move around panes easily
bind -n C-n select-pane -L
bind -n C-u select-pane -U
bind -n C-e select-pane -D
# bind -n C-i select-pane -R # removed because conflict with tab
bind -n C-j select-pane -R

## move around panes easily, be it tmux or nvim
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind -n 'C-n' if-shell "$is_vim" 'send-keys C-n' { if -F '#{pane_at_left}' '' 'select-pane -L' }
bind -n 'C-j' if-shell "$is_vim" 'send-keys C-j' { if -F '#{pane_at_right}' '' 'select-pane -R' }
bind -n 'C-u' if-shell "$is_vim" 'send-keys C-u' { if -F '#{pane_at_top}' '' 'select-pane -U' }
bind -n 'C-e' if-shell "$is_vim" 'send-keys C-e' { if -F '#{pane_at_bottom}' '' 'select-pane -D' }

## resize panes easily, be it tmux or nvim
bind -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'resize-pane -L 1'
bind -n 'C-y' if-shell "$is_vim" 'send-keys C-y' 'resize-pane -R 1'
bind -n 'M-l' if-shell "$is_vim" 'send-keys M-l' 'resize-pane -U 1'
bind -n 'M-y' if-shell "$is_vim" 'send-keys M-y' 'resize-pane -D 1'

# new pane in same directory
bind v split-window -h -c "#{pane_current_path}"
bind h split-window -v -c "#{pane_current_path}"
bind -n C-h split-window -v -c "#{pane_current_path}"
# layouts
bind -n M-Space next-layout
# use 'select-layout -o' to undo the last layout change.

# better window managment
bind n new-window -c "#{pane_current_path}"
bind -n C-k next
bind S command-prompt -p "send pane to:"  "join-pane -t '%%'"

# swap panes # disabled to loop through vim's history
# bind -n M-i swap-pane -D
# bind -n M-n swap-pane -U

# move between sessions
bind -n C-s switch-client -n

### options ###

set-option -g mouse on

# tmux-sensible
set -sg escape-time 5
set -g history-limit 50000
set -g display-time 4000
set -g status-interval 5
set -g default-terminal "screen-256color"
set -sa terminal-overrides ',screen-256color:RGB'

set -g status-keys emacs
set -g focus-events on

# start index for windows and panes
set -g base-index 1
set -g pane-base-index 1

# set active window styles and pane border style
set -g window-active-style 'fg=colour250,bg=black'
set -g pane-active-border-style 'fg=colour51'


### plugins ###
# Setup plugins:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
# how to ressurect other session:
# make sure you start this with a "fresh" tmux instance
# $ cd ~/.tmux/resurrect/
# locate the save file you'd like to use for restore (file names have a timestamp)
# symlink the last file to the desired save file: $ ln -sf <file_name> last
# do a restore with tmux-resurrect key: prefix + Ctrl-r
#


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
